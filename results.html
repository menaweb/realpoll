<!DOCTYPE html>
<html>
<head>
	<title>Realpoll</title>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	
	<!-- bootstrap -->
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
	<link href="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.1/css/bootstrap-combined.min.css" rel="stylesheet">
	<script src="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.1/js/bootstrap.min.js"></script>
	
	<!-- responsive -->
	<link href="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.1/css/bootstrap-responsive.min.css" rel="stylesheet">
	
	<!-- charts -->
    <!--Load the AJAX API-->
    <script type="text/javascript" src="https://www.google.com/jsapi"></script>
    <script type="text/javascript">
     var options = [0,0,0]; 
     var chart;
     var elapsed_seconds = 60;
     var timer;

      google.load('visualization', '1.0', {'packages':['corechart']});

      google.setOnLoadCallback(drawChart);
      
      function drawChart(){      
	    chart = new google.visualization.PieChart(document.getElementById('chart_div'));

        var data = new google.visualization.DataTable();
        data.addColumn('string', 'Answers');
        data.addColumn('number', 'Slices');
        
        var pref = {'title':'', 'width':500, 'height':300};            
        data.addRows([
          ['1', options[0]],
          ['2', options[1]],
          ['3', options[2]]	
        ]);
        chart.draw(data, pref);
    }
    
    function addValue(item){
    	options[item.option-1]++;
	    $('tbody').append('<tr><td>'+item.name+'<td><td class="hide">'+item.option+'<td></tr>');
	    drawChart();
    }
    
    

    
    // onload
    $(function(){
	    addValue({name:'miquel',option:1});
	    addValue({name:'miquel',option:2});
	   	    
	    timer = setInterval(function() {
			elapsed_seconds = elapsed_seconds - 1;
			if( elapsed_seconds > -1 ){
			
				if( elapsed_seconds < 11 ) $('#countdown').css('color','red');
				$('#countdown').text(elapsed_seconds);
			}else{
				
				clearTimeout( timer );
				$('.hide').removeClass('hide'); 
				$('#countdown').text("Time is up");
				
			}
		}, 1000);
    });
    </script>
	
</head>
<body>

<div class="container">

	<div class="row">
		<div class="span6">
		
			<legend>Results</legend>

			<table class="table table-striped">
				<thead>
					<tr>
						<th>Name<th>
						<th class="hide">Option<th>
					</tr>
				</thead>
				<tbody>
				</tbody>
  			</table>
			
		</div>
		
		<div class="span3">
			<div id="countdown" style="font-size:30px;font-weight:bold;padding:20px 0;">60</div>
			<div id="chart_div"></div>
		</div>
		
	</div>
</div>

</body>
</html>	